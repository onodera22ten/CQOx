# DAGåŒ…æ‹¬çš„åˆ†æã‚·ã‚¹ãƒ†ãƒ  - æœˆé¡100ä¸‡å††ã®ä¾¡å€¤

**PDFä»•æ§˜æ›¸å®Œå…¨æº–æ‹ **: `docs/DAG.pdf`

---

## ğŸ¯ æ¦‚è¦

DAGå› æœã‚°ãƒ©ãƒ•ã®**è­˜åˆ¥å¯èƒ½æ€§â†’ä»‹å…¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³â†’æ„Ÿåº¦åˆ†æâ†’ç›£æŸ»â†’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã¾ã§ä¸€æ°—é€šè²«ã§å®Ÿè¡Œã™ã‚‹ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ 

### å®Ÿè£…æ¸ˆã¿10ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

1. **Interactive DAG** (ãƒ—ãƒ­ãƒ´ãƒŠãƒ³ã‚¹&ä¿¡é ¼åº¦ãƒ¬ã‚¤ãƒ¤)
   - 2D/3D DAGå¯è¦–åŒ–
   - 360Â°ã‚¿ãƒ¼ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«GIF
   - éš£æ¥è¡Œåˆ—ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
   - æ¬¡æ•°åˆ†å¸ƒãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 

2. **Identifiability Assistant** (è­˜åˆ¥å¯èƒ½æ€§ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ)
   - Backdoor criterionè‡ªå‹•åˆ¤å®š
   - Frontdoor criterionåˆ¤å®š
   - æœ€å°èª¿æ•´é›†åˆã®ç™ºè¦‹
   - DAGãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º

3. **do-Operator Runner** (ä»‹å…¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³)
   - do(X=x)ä»‹å…¥åŠ¹æœæ¨å®š
   - ATE/CATE with 95% CI
   - Rosenbaum Î“æ„Ÿåº¦æ›²ç·š
   - KPIå½±éŸ¿ã®å®šé‡åŒ–

4. **Path & Bias Explorer** (ãƒ‘ã‚¹ãƒ»ãƒã‚¤ã‚¢ã‚¹æ¢ç´¢)
   - å…¨ãƒ‘ã‚¹åˆ—æŒ™ (direct/backdoor/collider)
   - M-biasè‡ªå‹•æ¤œå‡ºã¨è­¦å‘Š
   - Overcontrol biasè­¦å‘Š
   - ãƒã‚¤ã‚¢ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³å¯è¦–åŒ–

5. **IV Tester** (æ“ä½œå¤‰æ•°ãƒ†ã‚¹ã‚¿ãƒ¼)
   - First-stage Fçµ±è¨ˆé‡ (weak: F>10, strong: F>20)
   - 2SLS vs OLSæ¯”è¼ƒ
   - å¼±IVè­¦å‘Šã¨ä»£æ›¿æ¡ˆæç¤º

6. **CATE Heterogeneity** (ç•°è³ªåŠ¹æœåˆ†æ)
   - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ¥åŠ¹æœåˆ†å¸ƒ
   - ãƒˆãƒƒãƒ—/ãƒ¯ãƒ¼ã‚¹ãƒˆã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ç‰¹å®š
   - 3Då¯è¦–åŒ–: Cost Ã— CATE Ã— Segment
   - æ¨å¥¨ã‚¿ãƒ¼ã‚²ãƒ†ã‚£ãƒ³ã‚°è¡¨

7. **Timeseries DAG** (æ™‚ç³»åˆ—DAG)
   - ãƒ©ã‚°åŠ¹æœåˆ†æ
   - Adstock/æ¸›è¡°ãƒ¢ãƒ‡ãƒªãƒ³ã‚°
   - ã‚¤ãƒ™ãƒ³ãƒˆå½±éŸ¿åˆ†æ
   - 4Dã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å¯è¦–åŒ–

8. **Network Spillover** (ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒ”ãƒ«ã‚ªãƒ¼ãƒãƒ¼)
   - å¹²æ¸‰åŠ¹æœåˆ†æ
   - Transportabilityåˆ†æ
   - éš£æ¥è¡Œåˆ—ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—

9. **Data Audit & Quality Gates** (ãƒ‡ãƒ¼ã‚¿ç›£æŸ»)
   - **10å€‹ã®Quality Gateè‡ªå‹•ãƒã‚§ãƒƒã‚¯**:
     1. Overlap check (common support)
     2. t-statistic > 2.0
     3. IV F-statistic > 10
     4. SMD < 0.1
     5. Missing data < 10%
     6. Outliers < 5%
     7. Sample size â‰¥ 100
     8. Linearity (R > 0.5)
     9. Homoscedasticity
     10. Normality (Jarque-Bera)
   - Overlap/Love plot
   - Missing dataãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
   - Quality Gatesãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

10. **Export & Reproducibility** (ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ&å†ç¾æ€§)
    - GraphML/JSON/DOTå½¢å¼ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    - curlå†ç¾ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ
    - Pythonå†ç¾ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ
    - åŒ…æ‹¬çš„PDFãƒ¬ãƒãƒ¼ãƒˆ
    - å®Œå…¨ãªç›£æŸ»è¨¼è·¡

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### Backend

```
backend/
â”œâ”€â”€ engine/
â”‚   â””â”€â”€ router_dag_comprehensive.py  # 10ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â””â”€â”€ gateway/
    â””â”€â”€ app.py                       # ãƒ«ãƒ¼ã‚¿ãƒ¼ç™»éŒ²ï¼†artifactsé™çš„å…¬é–‹
```

### Frontend

```
frontend/src/
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ DAGComprehensivePage.tsx     # 10ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆUI
â”‚   â””â”€â”€ App.tsx                      # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ï¼ˆãƒªãƒ³ã‚¯è¿½åŠ æ¸ˆã¿ï¼‰
â””â”€â”€ main.tsx                         # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
```

### Wolfram Scripts

```
scripts/wolfram/dag/
â”œâ”€â”€ 01_interactive_dag.wl            # Module 1
â”œâ”€â”€ 02_identifiability.wl            # Module 2
â”œâ”€â”€ 03_do_operator.wl                # Module 3
â”œâ”€â”€ 04_path_bias_explorer.wl         # Module 4
â”œâ”€â”€ 05_iv_tester.wl                  # Module 5
â”œâ”€â”€ 06_cate_heterogeneity.wl         # Module 6
â”œâ”€â”€ 07_timeseries_dag.wl             # Module 7
â”œâ”€â”€ 08_network_spillover.wl          # Module 8
â”œâ”€â”€ 09_data_audit.wl                 # Module 9
â”œâ”€â”€ 10_export_reproducibility.wl     # Module 10
â””â”€â”€ README.md                        # è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

---

## ğŸš€ ä½¿ã„æ–¹

### 1. UIã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5173` ã‚’é–‹ã
2. ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‹ã‚‰ **ã€Œâ­ DAGåŒ…æ‹¬åˆ†æ (100ä¸‡å††ç´š)ã€** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. Dataset IDã€Treatmentã€Outcomeã€Adjustmentã‚’å…¥åŠ›
4. **ã€Œâ–¶ï¸ Run All 10 Modulesã€** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ
   - ã¾ãŸã¯ã€å€‹åˆ¥ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å˜ç‹¬å®Ÿè¡Œ

### 2. APIã‹ã‚‰ç›´æ¥å®Ÿè¡Œ

```bash
# å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ
curl -X POST http://localhost:8000/api/dag/run-all \
  -H "Content-Type: application/json" \
  -d '{
    "dataset_id": "your_dataset_id",
    "treatment": "X1",
    "outcome": "Y",
    "adjustment": ["Z"]
  }'

# å˜ä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ (ä¾‹: Module 2 - Identifiability)
curl -X POST http://localhost:8000/api/dag/module/2 \
  -H "Content-Type: application/json" \
  -d '{
    "dataset_id": "your_dataset_id",
    "treatment": "X1",
    "outcome": "Y"
  }'
```

### 3. ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ (ãƒ‡ãƒ¼ã‚¿ãªã—ã§å‹•ä½œç¢ºèª)

å…¨ã¦ã®Wolframã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ `--demo` ãƒ•ãƒ©ã‚°ã§åˆæˆãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ï¼š

```bash
# Module 1 ãƒ‡ãƒ¢å®Ÿè¡Œ
wolframscript -file scripts/wolfram/dag/01_interactive_dag.wl --demo

# Module 9 ãƒ‡ãƒ¢å®Ÿè¡Œ
wolframscript -file scripts/wolfram/dag/09_data_audit.wl --demo
```

---

## ğŸ“Š å‡ºåŠ›ä¾‹

å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ã‚’ç”Ÿæˆã—ã¾ã™ï¼š

### Module 1: Interactive DAG
- `interactive_dag_2d.png/svg` - 2D DAG (Layered layout)
- `interactive_dag_3d.png` - 3D DAG (Spring embedding)
- `interactive_dag_3d_turntable.gif` - 360Â°å›è»¢GIF
- `adjacency_matrix.png/csv` - éš£æ¥è¡Œåˆ—
- `degree_distribution.png` - æ¬¡æ•°åˆ†å¸ƒ

### Module 2: Identifiability
- `backdoor_sets.json` - æœ‰åŠ¹ãªèª¿æ•´é›†åˆãƒªã‚¹ãƒˆ
- `frontdoor_sets.json` - æœ‰åŠ¹ãªåª’ä»‹é›†åˆãƒªã‚¹ãƒˆ
- `dag_backdoor_highlighted.png` - Backdoorå¼·èª¿è¡¨ç¤ºDAG
- `identifiability_result.json` - è­˜åˆ¥å¯èƒ½æ€§çµæœ

### Module 3: do-Operator
- `intervention_curve.png` - do(X)ä»‹å…¥æ›²ç·š
- `ate_cate_ci.png` - ATE/CATE withä¿¡é ¼åŒºé–“
- `sensitivity_gamma.png` - Rosenbaum Î“æ›²ç·š
- `intervention_results.json` - æ¨å®šçµæœ

... (ä»¥ä¸‹åŒæ§˜ã«å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‡ºåŠ›)

---

## ğŸ¨ UIç‰¹å¾´

- **10å€‹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰**: å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆPending/Running/Success/Errorï¼‰ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
- **ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ**: æˆåŠŸã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®çµæœã‚’å³åº§ã«åˆ‡ã‚Šæ›¿ãˆ
- **ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: PNG/SVG/GIFã‚’ç›´æ¥è¡¨ç¤º
- **ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯**: JSON/CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å¤±æ•—ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

---

## ğŸ”¬ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### Backend
- **FastAPI**: RESTful API
- **subprocess**: Wolframã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
- **Pydantic**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

### Frontend
- **React**: UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **TypeScript**: å‹å®‰å…¨
- **React Router**: ãƒšãƒ¼ã‚¸ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

### Computation
- **Wolfram ONE**: å…¨10ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è¨ˆç®—ãƒ»å¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³
- **NetworkX**: DAGæ“ä½œï¼ˆWolframã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ï¼‰
- **NumPy/Pandas**: ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆWolframã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ï¼‰

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å®Ÿè£…å®Œäº†é …ç›®
- [x] Wolframã‚¹ã‚¯ãƒªãƒ—ãƒˆ10å€‹å®Œæˆ
- [x] ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Ÿè£…ï¼ˆå…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å¯¾å¿œï¼‰
- [x] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çµ±åˆUIå®Ÿè£…
- [x] ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
- [x] artifactsé™çš„å…¬é–‹
- [x] ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ãƒªãƒ³ã‚¯
- [x] ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼ˆå…¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

### ç¢ºèªé …ç›®
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã§UIã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- [ ] å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ­£å¸¸å®Ÿè¡Œï¼ˆãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§ç¢ºèªï¼‰
- [ ] ç”Ÿæˆã•ã‚ŒãŸç”»åƒ/JSON/CSVãŒæ­£å¸¸è¡¨ç¤º/ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½

---

## ğŸ“– å‚è€ƒè³‡æ–™

- **PDFä»•æ§˜æ›¸**: `docs/DAG.pdf` (11ãƒšãƒ¼ã‚¸)
- **Wolframã‚¹ã‚¯ãƒªãƒ—ãƒˆè©³ç´°**: `scripts/wolfram/dag/README.md`
- **Pearl, J. (2009)**: Causality: Models, Reasoning, and Inference
- **HernÃ¡n, M. A., & Robins, J. M. (2020)**: Causal Inference: What If
- **DoWhy Library**: https://github.com/py-why/dowhy

---

## ğŸ’¡ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Wolfram ONEãƒ©ã‚¤ã‚»ãƒ³ã‚¹å–å¾—** (ç¾åœ¨ã¯ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œ)
2. **å®Ÿãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª**
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–** (å¤§è¦æ¨¡DAGå¯¾å¿œ)
4. **å…±é€šè¨ºæ–­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¿½åŠ ** (Î“æ›²ç·šã€Overlapã€ATEå¯†åº¦ã®å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)

---

**å®Ÿè£…å®Œäº†æ—¥**: 2025-11-14
**ç›®æ¨™**: æœˆé¡100ä¸‡å††ã®ãƒãƒªãƒ¥ãƒ¼å®Ÿç¾
**ä»•æ§˜æ›¸æº–æ‹ **: docs/DAG.pdf å®Œå…¨æº–æ‹ 
